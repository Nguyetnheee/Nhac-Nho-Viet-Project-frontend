{"ast":null,"code":"var _jsxFileName = \"D:\\\\UNIVERSITY\\\\FALL 25\\\\ISP392\\\\FINAL PROJECT\\\\frontend_new\\\\frontend\\\\src\\\\contexts\\\\CartContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/contexts/CartContext.js\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"./AuthContext\";\nimport * as cartService from \"../services/cartService\";\nimport { useToast } from '../components/ToastContainer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartContext = /*#__PURE__*/createContext();\nexport const useCart = () => {\n  _s();\n  const ctx = useContext(CartContext);\n  if (!ctx) throw new Error(\"useCart must be used within a CartProvider\");\n  return ctx;\n};\n_s(useCart, \"/dMy7t63NXD4eYACoT93CePwGrg=\");\nexport const CartProvider = ({\n  children\n}) => {\n  _s2();\n  const {\n    isAuthenticated,\n    token\n  } = useAuth();\n  const navigate = useNavigate();\n  const {\n    showSuccess\n  } = useToast();\n\n  // Server state only\n  const [cartItems, setCartItems] = useState([]);\n  const [totals, setTotals] = useState({\n    totalItems: 0,\n    subTotal: 0,\n    currency: \"\"\n  });\n  const [serverSynced, setServerSynced] = useState(false);\n  const [error, setError] = useState(null);\n\n  // -------- Adapter theo schema GET /api/cart --------\n  const adaptCartFromApi = apiCart => {\n    const items = Array.isArray(apiCart === null || apiCart === void 0 ? void 0 : apiCart.items) ? apiCart.items : [];\n    const mapped = items.map(i => {\n      var _i$cartItemId, _i$selected;\n      return {\n        id: (_i$cartItemId = i.cartItemId) !== null && _i$cartItemId !== void 0 ? _i$cartItemId : i.productId,\n        cartItemId: i.cartItemId,\n        productId: i.productId,\n        name: i.productName,\n        productName: i.productName,\n        imageUrl: i.productImage,\n        price: Number(i.unitPrice) || 0,\n        quantity: Number(i.quantity) || 0,\n        lineTotal: Number(i.lineTotal) || 0,\n        selected: (_i$selected = i.selected) !== null && _i$selected !== void 0 ? _i$selected : true\n      };\n    });\n    return {\n      items: mapped,\n      totals: {\n        totalItems: Number(apiCart === null || apiCart === void 0 ? void 0 : apiCart.totalItems) || 0,\n        subTotal: Number(apiCart === null || apiCart === void 0 ? void 0 : apiCart.subTotal) || 0,\n        currency: (apiCart === null || apiCart === void 0 ? void 0 : apiCart.currency) || \"VND\"\n      }\n    };\n  };\n\n  // -------- Helpers --------\n  const requireAuth = () => {\n    setError({\n      type: \"auth\",\n      message: \"Bạn cần đăng nhập để tiếp tục mua hàng\"\n    });\n    setTimeout(() => navigate(\"/login\"), 1200);\n  };\n\n  // -------- API calls --------\n  const fetchCart = async () => {\n    if (!isAuthenticated || !token) {\n      setServerSynced(false);\n      setError({\n        type: \"auth\",\n        message: \"Vui lòng đăng nhập để xem giỏ hàng.\"\n      });\n      navigate('/login');\n      return;\n    }\n    try {\n      const data = await cartService.getCart();\n      if (data) {\n        const {\n          items,\n          totals\n        } = adaptCartFromApi(data);\n        setCartItems(items);\n        setTotals(totals);\n        setServerSynced(true);\n        setError(null);\n      }\n    } catch (err) {\n      var _err$response, _err$response2;\n      console.error(\"fetchCart error:\", err);\n      setServerSynced(false);\n      if ((err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 401) {\n        setError({\n          type: \"auth\",\n          message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\"\n        });\n        navigate('/login');\n      } else if ((err === null || err === void 0 ? void 0 : (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.status) === 403) {\n        setError({\n          type: \"auth\",\n          message: \"Tài khoản của bạn không có quyền xem giỏ hàng.\"\n        });\n        navigate('/');\n      } else {\n        setError({\n          type: \"error\",\n          message: \"Không thể tải giỏ hàng từ server. Vui lòng thử lại.\"\n        });\n      }\n    }\n  };\n  const addToCart = async (productOrId, quantity = 1) => {\n    var _productOrId$productI;\n    if (!isAuthenticated) return requireAuth();\n    const productId = typeof productOrId === \"object\" ? (_productOrId$productI = productOrId.productId) !== null && _productOrId$productI !== void 0 ? _productOrId$productI : productOrId.id : productOrId;\n    if (productId === undefined || productId === null) {\n      setError({\n        type: \"error\",\n        message: \"Không xác định được sản phẩm.\"\n      });\n      return;\n    }\n    try {\n      // BE: quantity là ABSOLUTE khi tạo/cập nhật (ở đây thêm 1 thì gửi 1)\n      await cartService.updateCartItem(productId, Number(quantity) || 1);\n      await fetchCart();\n      setError(null);\n      showSuccess(\"Đã cập nhật giỏ hàng thành công!\"); // Hiển thị toast\n    } catch (err) {\n      console.error(\"addToCart error:\", err);\n      if ((err === null || err === void 0 ? void 0 : err.status) === 401) setError({\n        type: \"auth\",\n        message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\"\n      });else if ((err === null || err === void 0 ? void 0 : err.status) === 403) setError({\n        type: \"auth\",\n        message: \"Tài khoản của bạn không có quyền thao tác giỏ hàng.\"\n      });else setError({\n        type: \"error\",\n        message: \"Không thể thêm sản phẩm. Vui lòng thử lại sau.\"\n      });\n    }\n  };\n\n  // Cập nhật số lượng sản phẩm\n  const updateQuantity = async (productId, nextQty) => {\n    if (!isAuthenticated) return requireAuth();\n    try {\n      var _currentCart$items;\n      // Lấy thông tin sản phẩm hiện tại từ server\n      const currentCart = await cartService.getCart();\n      const currentItem = (_currentCart$items = currentCart.items) === null || _currentCart$items === void 0 ? void 0 : _currentCart$items.find(item => item.productId === productId);\n      if (!currentItem) {\n        setError({\n          type: \"error\",\n          message: \"Không tìm thấy sản phẩm trong giỏ hàng.\"\n        });\n        return;\n      }\n      const currentQty = Number(currentItem.quantity) || 0;\n      const desiredQty = Number(nextQty);\n\n      // Validate số lượng mới\n      if (!Number.isFinite(desiredQty) || desiredQty < 0) {\n        setError({\n          type: \"error\",\n          message: \"Số lượng không hợp lệ.\"\n        });\n        return;\n      }\n\n      // Nếu số lượng = 0, xóa sản phẩm\n      if (desiredQty === 0) {\n        await cartService.removeFromCart(productId);\n        await fetchCart();\n        setError(null);\n        return;\n      }\n\n      // Cập nhật số lượng trên server\n      await cartService.updateCartItem(productId, desiredQty);\n\n      // Refresh lại data từ server\n      await fetchCart();\n      setError(null);\n    } catch (err) {\n      console.error(\"updateQuantity error:\", err);\n      // Nếu lỗi, refresh lại data từ server\n      await fetchCart();\n      if ((err === null || err === void 0 ? void 0 : err.status) === 401) {\n        setError({\n          type: \"auth\",\n          message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\"\n        });\n      } else if ((err === null || err === void 0 ? void 0 : err.status) === 403) {\n        setError({\n          type: \"auth\",\n          message: \"Tài khoản của bạn không có quyền thao tác giỏ hàng.\"\n        });\n      } else {\n        setError({\n          type: \"error\",\n          message: \"Không thể cập nhật số lượng. Vui lòng thử lại sau.\"\n        });\n      }\n    }\n  };\n  const removeFromCart = async productId => {\n    if (!isAuthenticated) return requireAuth();\n    try {\n      await cartService.removeFromCart(productId); // POST /api/cart/items/remove?productId=...\n      await fetchCart();\n      setError(null);\n    } catch (err) {\n      console.error(\"removeFromCart error:\", err);\n      if ((err === null || err === void 0 ? void 0 : err.status) === 401) setError({\n        type: \"auth\",\n        message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\"\n      });else if ((err === null || err === void 0 ? void 0 : err.status) === 403) setError({\n        type: \"auth\",\n        message: \"Tài khoản của bạn không có quyền thao tác giỏ hàng.\"\n      });else setError({\n        type: \"error\",\n        message: \"Không thể xóa sản phẩm. Vui lòng thử lại sau.\"\n      });\n    }\n  };\n  const clearCart = async () => {\n    if (!isAuthenticated) return requireAuth();\n    try {\n      await cartService.clearCart(); // nếu BE hỗ trợ /api/cart/clear\n      await fetchCart();\n      setError(null);\n    } catch (err) {\n      console.error(\"clearCart error:\", err);\n      if ((err === null || err === void 0 ? void 0 : err.status) === 401) setError({\n        type: \"auth\",\n        message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\"\n      });else if ((err === null || err === void 0 ? void 0 : err.status) === 403) setError({\n        type: \"auth\",\n        message: \"Tài khoản của bạn không có quyền thao tác giỏ hàng.\"\n      });else setError({\n        type: \"error\",\n        message: \"Không thể xóa giỏ hàng. Vui lòng thử lại sau.\"\n      });\n    }\n  };\n\n  // -------- Effects --------\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchCart();\n    } else {\n      setCartItems([]);\n      setTotals({\n        totalItems: 0,\n        subTotal: 0,\n        currency: \"\"\n      });\n      setServerSynced(false);\n      setError(null);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isAuthenticated]);\n\n  // -------- Selectors --------\n  const getTotalItems = () => totals.totalItems;\n  const getTotalPrice = () => totals.subTotal;\n  const getDistinctProductCount = () => {\n    return cartItems.length; // Số lượng loại sản phẩm khác nhau\n  };\n  const value = {\n    cartItems,\n    totals,\n    serverSynced,\n    addToCart,\n    updateQuantity,\n    removeFromCart,\n    clearCart,\n    fetchCart,\n    getTotalItems,\n    getTotalPrice,\n    getDistinctProductCount,\n    // Thêm selector\n    error\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: value,\n    children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `fixed top-4 right-4 p-4 rounded-lg ${(error === null || error === void 0 ? void 0 : error.type) === \"auth\" ? \"bg-blue-600 text-white\" : \"bg-red-600 text-white\"} shadow-lg z-50`,\n      children: error === null || error === void 0 ? void 0 : error.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 9\n    }, this), children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 234,\n    columnNumber: 5\n  }, this);\n};\n_s2(CartProvider, \"Vge6bMeStJ51PaIgHHrUfLf8djI=\", false, function () {\n  return [useAuth, useNavigate, useToast];\n});\n_c = CartProvider;\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","useNavigate","useAuth","cartService","useToast","jsxDEV","_jsxDEV","CartContext","useCart","_s","ctx","Error","CartProvider","children","_s2","isAuthenticated","token","navigate","showSuccess","cartItems","setCartItems","totals","setTotals","totalItems","subTotal","currency","serverSynced","setServerSynced","error","setError","adaptCartFromApi","apiCart","items","Array","isArray","mapped","map","i","_i$cartItemId","_i$selected","id","cartItemId","productId","name","productName","imageUrl","productImage","price","Number","unitPrice","quantity","lineTotal","selected","requireAuth","type","message","setTimeout","fetchCart","data","getCart","err","_err$response","_err$response2","console","response","status","addToCart","productOrId","_productOrId$productI","undefined","updateCartItem","updateQuantity","nextQty","_currentCart$items","currentCart","currentItem","find","item","currentQty","desiredQty","isFinite","removeFromCart","clearCart","getTotalItems","getTotalPrice","getDistinctProductCount","length","value","Provider","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/UNIVERSITY/FALL 25/ISP392/FINAL PROJECT/frontend_new/frontend/src/contexts/CartContext.js"],"sourcesContent":["// src/contexts/CartContext.js\r\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"./AuthContext\";\r\nimport * as cartService from \"../services/cartService\";\r\nimport { useToast } from '../components/ToastContainer';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport const useCart = () => {\r\n  const ctx = useContext(CartContext);\r\n  if (!ctx) throw new Error(\"useCart must be used within a CartProvider\");\r\n  return ctx;\r\n};\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const { isAuthenticated, token } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { showSuccess } = useToast();\r\n\r\n  // Server state only\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [totals, setTotals] = useState({ totalItems: 0, subTotal: 0, currency: \"\" });\r\n  const [serverSynced, setServerSynced] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  // -------- Adapter theo schema GET /api/cart --------\r\n  const adaptCartFromApi = (apiCart) => {\r\n    const items = Array.isArray(apiCart?.items) ? apiCart.items : [];\r\n    const mapped = items.map((i) => ({\r\n      id: i.cartItemId ?? i.productId,\r\n      cartItemId: i.cartItemId,\r\n      productId: i.productId,\r\n      name: i.productName,\r\n      productName: i.productName,\r\n      imageUrl: i.productImage,\r\n      price: Number(i.unitPrice) || 0,\r\n      quantity: Number(i.quantity) || 0,\r\n      lineTotal: Number(i.lineTotal) || 0,\r\n      selected: i.selected ?? true\r\n    }));\r\n\r\n    return {\r\n      items: mapped,\r\n      totals: {\r\n        totalItems: Number(apiCart?.totalItems) || 0,\r\n        subTotal: Number(apiCart?.subTotal) || 0,\r\n        currency: apiCart?.currency || \"VND\",\r\n      },\r\n    };\r\n  };\r\n\r\n  // -------- Helpers --------\r\n  const requireAuth = () => {\r\n    setError({ type: \"auth\", message: \"Bạn cần đăng nhập để tiếp tục mua hàng\" });\r\n    setTimeout(() => navigate(\"/login\"), 1200);\r\n  };\r\n\r\n  // -------- API calls --------\r\n  const fetchCart = async () => {\r\n    if (!isAuthenticated || !token) {\r\n      setServerSynced(false);\r\n      setError({ type: \"auth\", message: \"Vui lòng đăng nhập để xem giỏ hàng.\" });\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const data = await cartService.getCart();\r\n      if (data) {\r\n        const { items, totals } = adaptCartFromApi(data);\r\n        setCartItems(items);\r\n        setTotals(totals);\r\n        setServerSynced(true);\r\n        setError(null);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"fetchCart error:\", err);\r\n      setServerSynced(false);\r\n      if (err?.response?.status === 401) {\r\n        setError({ type: \"auth\", message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\" });\r\n        navigate('/login');\r\n      } else if (err?.response?.status === 403) {\r\n        setError({ type: \"auth\", message: \"Tài khoản của bạn không có quyền xem giỏ hàng.\" });\r\n        navigate('/');\r\n      } else {\r\n        setError({ type: \"error\", message: \"Không thể tải giỏ hàng từ server. Vui lòng thử lại.\" });\r\n      }\r\n    }\r\n  };\r\n\r\n  const addToCart = async (productOrId, quantity = 1) => {\r\n    if (!isAuthenticated) return requireAuth();\r\n\r\n    const productId =\r\n      typeof productOrId === \"object\"\r\n        ? productOrId.productId ?? productOrId.id\r\n        : productOrId;\r\n\r\n    if (productId === undefined || productId === null) {\r\n      setError({ type: \"error\", message: \"Không xác định được sản phẩm.\" });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // BE: quantity là ABSOLUTE khi tạo/cập nhật (ở đây thêm 1 thì gửi 1)\r\n      await cartService.updateCartItem(productId, Number(quantity) || 1);\r\n      await fetchCart();\r\n      setError(null);\r\n      showSuccess(\"Đã cập nhật giỏ hàng thành công!\"); // Hiển thị toast\r\n    } catch (err) {\r\n      console.error(\"addToCart error:\", err);\r\n      if (err?.status === 401) setError({ type: \"auth\", message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\" });\r\n      else if (err?.status === 403) setError({ type: \"auth\", message: \"Tài khoản của bạn không có quyền thao tác giỏ hàng.\" });\r\n      else setError({ type: \"error\", message: \"Không thể thêm sản phẩm. Vui lòng thử lại sau.\" });\r\n    }\r\n  };\r\n\r\n  // Cập nhật số lượng sản phẩm\r\n  const updateQuantity = async (productId, nextQty) => {\r\n    if (!isAuthenticated) return requireAuth();\r\n\r\n    try {\r\n      // Lấy thông tin sản phẩm hiện tại từ server\r\n      const currentCart = await cartService.getCart();\r\n      const currentItem = currentCart.items?.find(item => item.productId === productId);\r\n      \r\n      if (!currentItem) {\r\n        setError({ type: \"error\", message: \"Không tìm thấy sản phẩm trong giỏ hàng.\" });\r\n        return;\r\n      }\r\n\r\n      const currentQty = Number(currentItem.quantity) || 0;\r\n      const desiredQty = Number(nextQty);\r\n\r\n      // Validate số lượng mới\r\n      if (!Number.isFinite(desiredQty) || desiredQty < 0) {\r\n        setError({ type: \"error\", message: \"Số lượng không hợp lệ.\" });\r\n        return;\r\n      }\r\n\r\n      // Nếu số lượng = 0, xóa sản phẩm\r\n      if (desiredQty === 0) {\r\n        await cartService.removeFromCart(productId);\r\n        await fetchCart();\r\n        setError(null);\r\n        return;\r\n      }\r\n\r\n      // Cập nhật số lượng trên server\r\n      await cartService.updateCartItem(productId, desiredQty);\r\n      \r\n      // Refresh lại data từ server\r\n      await fetchCart();\r\n      setError(null);\r\n    } catch (err) {\r\n      console.error(\"updateQuantity error:\", err);\r\n      // Nếu lỗi, refresh lại data từ server\r\n      await fetchCart();\r\n      if (err?.status === 401) {\r\n        setError({ type: \"auth\", message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\" });\r\n      } else if (err?.status === 403) {\r\n        setError({ type: \"auth\", message: \"Tài khoản của bạn không có quyền thao tác giỏ hàng.\" });\r\n      } else {\r\n        setError({ type: \"error\", message: \"Không thể cập nhật số lượng. Vui lòng thử lại sau.\" });\r\n      }\r\n    }\r\n  };\r\n\r\n  const removeFromCart = async (productId) => {\r\n    if (!isAuthenticated) return requireAuth();\r\n    try {\r\n      await cartService.removeFromCart(productId); // POST /api/cart/items/remove?productId=...\r\n      await fetchCart();\r\n      setError(null);\r\n    } catch (err) {\r\n      console.error(\"removeFromCart error:\", err);\r\n      if (err?.status === 401) setError({ type: \"auth\", message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\" });\r\n      else if (err?.status === 403) setError({ type: \"auth\", message: \"Tài khoản của bạn không có quyền thao tác giỏ hàng.\" });\r\n      else setError({ type: \"error\", message: \"Không thể xóa sản phẩm. Vui lòng thử lại sau.\" });\r\n    }\r\n  };\r\n\r\n  const clearCart = async () => {\r\n    if (!isAuthenticated) return requireAuth();\r\n    try {\r\n      await cartService.clearCart(); // nếu BE hỗ trợ /api/cart/clear\r\n      await fetchCart();\r\n      setError(null);\r\n    } catch (err) {\r\n      console.error(\"clearCart error:\", err);\r\n      if (err?.status === 401) setError({ type: \"auth\", message: \"Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.\" });\r\n      else if (err?.status === 403) setError({ type: \"auth\", message: \"Tài khoản của bạn không có quyền thao tác giỏ hàng.\" });\r\n      else setError({ type: \"error\", message: \"Không thể xóa giỏ hàng. Vui lòng thử lại sau.\" });\r\n    }\r\n  };\r\n\r\n  // -------- Effects --------\r\n  useEffect(() => {\r\n    if (isAuthenticated) {\r\n      fetchCart();\r\n    } else {\r\n      setCartItems([]);\r\n      setTotals({ totalItems: 0, subTotal: 0, currency: \"\" });\r\n      setServerSynced(false);\r\n      setError(null);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isAuthenticated]);\r\n\r\n  // -------- Selectors --------\r\n  const getTotalItems = () => totals.totalItems;\r\n  const getTotalPrice = () => totals.subTotal;\r\n  const getDistinctProductCount = () => {\r\n    return cartItems.length; // Số lượng loại sản phẩm khác nhau\r\n  };\r\n\r\n  const value = {\r\n    cartItems,\r\n    totals,\r\n    serverSynced,\r\n    addToCart,\r\n    updateQuantity,\r\n    removeFromCart,\r\n    clearCart,\r\n    fetchCart,\r\n    getTotalItems,\r\n    getTotalPrice,\r\n    getDistinctProductCount, // Thêm selector\r\n    error,\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider value={value}>\r\n      {error && (\r\n        <div\r\n          className={`fixed top-4 right-4 p-4 rounded-lg ${\r\n            error?.type === \"auth\" ? \"bg-blue-600 text-white\" : \"bg-red-600 text-white\"\r\n          } shadow-lg z-50`}\r\n        >\r\n          {error?.message}\r\n        </div>\r\n      )}\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n"],"mappings":";;;AAAA;AACA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC7E,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,OAAO,QAAQ,eAAe;AACvC,OAAO,KAAKC,WAAW,MAAM,yBAAyB;AACtD,SAASC,QAAQ,QAAQ,8BAA8B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExD,MAAMC,WAAW,gBAAGV,aAAa,CAAC,CAAC;AAEnC,OAAO,MAAMW,OAAO,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAMC,GAAG,GAAGZ,UAAU,CAACS,WAAW,CAAC;EACnC,IAAI,CAACG,GAAG,EAAE,MAAM,IAAIC,KAAK,CAAC,4CAA4C,CAAC;EACvE,OAAOD,GAAG;AACZ,CAAC;AAACD,EAAA,CAJWD,OAAO;AAMpB,OAAO,MAAMI,YAAY,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,GAAA;EAC5C,MAAM;IAAEC,eAAe;IAAEC;EAAM,CAAC,GAAGd,OAAO,CAAC,CAAC;EAC5C,MAAMe,QAAQ,GAAGhB,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAEiB;EAAY,CAAC,GAAGd,QAAQ,CAAC,CAAC;;EAElC;EACA,MAAM,CAACe,SAAS,EAAEC,YAAY,CAAC,GAAGpB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACqB,MAAM,EAAEC,SAAS,CAAC,GAAGtB,QAAQ,CAAC;IAAEuB,UAAU,EAAE,CAAC;IAAEC,QAAQ,EAAE,CAAC;IAAEC,QAAQ,EAAE;EAAG,CAAC,CAAC;EAClF,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAG3B,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAAC4B,KAAK,EAAEC,QAAQ,CAAC,GAAG7B,QAAQ,CAAC,IAAI,CAAC;;EAExC;EACA,MAAM8B,gBAAgB,GAAIC,OAAO,IAAK;IACpC,MAAMC,KAAK,GAAGC,KAAK,CAACC,OAAO,CAACH,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEC,KAAK,CAAC,GAAGD,OAAO,CAACC,KAAK,GAAG,EAAE;IAChE,MAAMG,MAAM,GAAGH,KAAK,CAACI,GAAG,CAAEC,CAAC;MAAA,IAAAC,aAAA,EAAAC,WAAA;MAAA,OAAM;QAC/BC,EAAE,GAAAF,aAAA,GAAED,CAAC,CAACI,UAAU,cAAAH,aAAA,cAAAA,aAAA,GAAID,CAAC,CAACK,SAAS;QAC/BD,UAAU,EAAEJ,CAAC,CAACI,UAAU;QACxBC,SAAS,EAAEL,CAAC,CAACK,SAAS;QACtBC,IAAI,EAAEN,CAAC,CAACO,WAAW;QACnBA,WAAW,EAAEP,CAAC,CAACO,WAAW;QAC1BC,QAAQ,EAAER,CAAC,CAACS,YAAY;QACxBC,KAAK,EAAEC,MAAM,CAACX,CAAC,CAACY,SAAS,CAAC,IAAI,CAAC;QAC/BC,QAAQ,EAAEF,MAAM,CAACX,CAAC,CAACa,QAAQ,CAAC,IAAI,CAAC;QACjCC,SAAS,EAAEH,MAAM,CAACX,CAAC,CAACc,SAAS,CAAC,IAAI,CAAC;QACnCC,QAAQ,GAAAb,WAAA,GAAEF,CAAC,CAACe,QAAQ,cAAAb,WAAA,cAAAA,WAAA,GAAI;MAC1B,CAAC;IAAA,CAAC,CAAC;IAEH,OAAO;MACLP,KAAK,EAAEG,MAAM;MACbd,MAAM,EAAE;QACNE,UAAU,EAAEyB,MAAM,CAACjB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAER,UAAU,CAAC,IAAI,CAAC;QAC5CC,QAAQ,EAAEwB,MAAM,CAACjB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEP,QAAQ,CAAC,IAAI,CAAC;QACxCC,QAAQ,EAAE,CAAAM,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEN,QAAQ,KAAI;MACjC;IACF,CAAC;EACH,CAAC;;EAED;EACA,MAAM4B,WAAW,GAAGA,CAAA,KAAM;IACxBxB,QAAQ,CAAC;MAAEyB,IAAI,EAAE,MAAM;MAAEC,OAAO,EAAE;IAAyC,CAAC,CAAC;IAC7EC,UAAU,CAAC,MAAMvC,QAAQ,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC;EAC5C,CAAC;;EAED;EACA,MAAMwC,SAAS,GAAG,MAAAA,CAAA,KAAY;IAC5B,IAAI,CAAC1C,eAAe,IAAI,CAACC,KAAK,EAAE;MAC9BW,eAAe,CAAC,KAAK,CAAC;MACtBE,QAAQ,CAAC;QAAEyB,IAAI,EAAE,MAAM;QAAEC,OAAO,EAAE;MAAsC,CAAC,CAAC;MAC1EtC,QAAQ,CAAC,QAAQ,CAAC;MAClB;IACF;IAEA,IAAI;MACF,MAAMyC,IAAI,GAAG,MAAMvD,WAAW,CAACwD,OAAO,CAAC,CAAC;MACxC,IAAID,IAAI,EAAE;QACR,MAAM;UAAE1B,KAAK;UAAEX;QAAO,CAAC,GAAGS,gBAAgB,CAAC4B,IAAI,CAAC;QAChDtC,YAAY,CAACY,KAAK,CAAC;QACnBV,SAAS,CAACD,MAAM,CAAC;QACjBM,eAAe,CAAC,IAAI,CAAC;QACrBE,QAAQ,CAAC,IAAI,CAAC;MAChB;IACF,CAAC,CAAC,OAAO+B,GAAG,EAAE;MAAA,IAAAC,aAAA,EAAAC,cAAA;MACZC,OAAO,CAACnC,KAAK,CAAC,kBAAkB,EAAEgC,GAAG,CAAC;MACtCjC,eAAe,CAAC,KAAK,CAAC;MACtB,IAAI,CAAAiC,GAAG,aAAHA,GAAG,wBAAAC,aAAA,GAAHD,GAAG,CAAEI,QAAQ,cAAAH,aAAA,uBAAbA,aAAA,CAAeI,MAAM,MAAK,GAAG,EAAE;QACjCpC,QAAQ,CAAC;UAAEyB,IAAI,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAmD,CAAC,CAAC;QACvFtC,QAAQ,CAAC,QAAQ,CAAC;MACpB,CAAC,MAAM,IAAI,CAAA2C,GAAG,aAAHA,GAAG,wBAAAE,cAAA,GAAHF,GAAG,CAAEI,QAAQ,cAAAF,cAAA,uBAAbA,cAAA,CAAeG,MAAM,MAAK,GAAG,EAAE;QACxCpC,QAAQ,CAAC;UAAEyB,IAAI,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAiD,CAAC,CAAC;QACrFtC,QAAQ,CAAC,GAAG,CAAC;MACf,CAAC,MAAM;QACLY,QAAQ,CAAC;UAAEyB,IAAI,EAAE,OAAO;UAAEC,OAAO,EAAE;QAAsD,CAAC,CAAC;MAC7F;IACF;EACF,CAAC;EAED,MAAMW,SAAS,GAAG,MAAAA,CAAOC,WAAW,EAAEjB,QAAQ,GAAG,CAAC,KAAK;IAAA,IAAAkB,qBAAA;IACrD,IAAI,CAACrD,eAAe,EAAE,OAAOsC,WAAW,CAAC,CAAC;IAE1C,MAAMX,SAAS,GACb,OAAOyB,WAAW,KAAK,QAAQ,IAAAC,qBAAA,GAC3BD,WAAW,CAACzB,SAAS,cAAA0B,qBAAA,cAAAA,qBAAA,GAAID,WAAW,CAAC3B,EAAE,GACvC2B,WAAW;IAEjB,IAAIzB,SAAS,KAAK2B,SAAS,IAAI3B,SAAS,KAAK,IAAI,EAAE;MACjDb,QAAQ,CAAC;QAAEyB,IAAI,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAgC,CAAC,CAAC;MACrE;IACF;IAEA,IAAI;MACF;MACA,MAAMpD,WAAW,CAACmE,cAAc,CAAC5B,SAAS,EAAEM,MAAM,CAACE,QAAQ,CAAC,IAAI,CAAC,CAAC;MAClE,MAAMO,SAAS,CAAC,CAAC;MACjB5B,QAAQ,CAAC,IAAI,CAAC;MACdX,WAAW,CAAC,kCAAkC,CAAC,CAAC,CAAC;IACnD,CAAC,CAAC,OAAO0C,GAAG,EAAE;MACZG,OAAO,CAACnC,KAAK,CAAC,kBAAkB,EAAEgC,GAAG,CAAC;MACtC,IAAI,CAAAA,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEK,MAAM,MAAK,GAAG,EAAEpC,QAAQ,CAAC;QAAEyB,IAAI,EAAE,MAAM;QAAEC,OAAO,EAAE;MAAmD,CAAC,CAAC,CAAC,KAC5G,IAAI,CAAAK,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEK,MAAM,MAAK,GAAG,EAAEpC,QAAQ,CAAC;QAAEyB,IAAI,EAAE,MAAM;QAAEC,OAAO,EAAE;MAAsD,CAAC,CAAC,CAAC,KACpH1B,QAAQ,CAAC;QAAEyB,IAAI,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAiD,CAAC,CAAC;IAC7F;EACF,CAAC;;EAED;EACA,MAAMgB,cAAc,GAAG,MAAAA,CAAO7B,SAAS,EAAE8B,OAAO,KAAK;IACnD,IAAI,CAACzD,eAAe,EAAE,OAAOsC,WAAW,CAAC,CAAC;IAE1C,IAAI;MAAA,IAAAoB,kBAAA;MACF;MACA,MAAMC,WAAW,GAAG,MAAMvE,WAAW,CAACwD,OAAO,CAAC,CAAC;MAC/C,MAAMgB,WAAW,IAAAF,kBAAA,GAAGC,WAAW,CAAC1C,KAAK,cAAAyC,kBAAA,uBAAjBA,kBAAA,CAAmBG,IAAI,CAACC,IAAI,IAAIA,IAAI,CAACnC,SAAS,KAAKA,SAAS,CAAC;MAEjF,IAAI,CAACiC,WAAW,EAAE;QAChB9C,QAAQ,CAAC;UAAEyB,IAAI,EAAE,OAAO;UAAEC,OAAO,EAAE;QAA0C,CAAC,CAAC;QAC/E;MACF;MAEA,MAAMuB,UAAU,GAAG9B,MAAM,CAAC2B,WAAW,CAACzB,QAAQ,CAAC,IAAI,CAAC;MACpD,MAAM6B,UAAU,GAAG/B,MAAM,CAACwB,OAAO,CAAC;;MAElC;MACA,IAAI,CAACxB,MAAM,CAACgC,QAAQ,CAACD,UAAU,CAAC,IAAIA,UAAU,GAAG,CAAC,EAAE;QAClDlD,QAAQ,CAAC;UAAEyB,IAAI,EAAE,OAAO;UAAEC,OAAO,EAAE;QAAyB,CAAC,CAAC;QAC9D;MACF;;MAEA;MACA,IAAIwB,UAAU,KAAK,CAAC,EAAE;QACpB,MAAM5E,WAAW,CAAC8E,cAAc,CAACvC,SAAS,CAAC;QAC3C,MAAMe,SAAS,CAAC,CAAC;QACjB5B,QAAQ,CAAC,IAAI,CAAC;QACd;MACF;;MAEA;MACA,MAAM1B,WAAW,CAACmE,cAAc,CAAC5B,SAAS,EAAEqC,UAAU,CAAC;;MAEvD;MACA,MAAMtB,SAAS,CAAC,CAAC;MACjB5B,QAAQ,CAAC,IAAI,CAAC;IAChB,CAAC,CAAC,OAAO+B,GAAG,EAAE;MACZG,OAAO,CAACnC,KAAK,CAAC,uBAAuB,EAAEgC,GAAG,CAAC;MAC3C;MACA,MAAMH,SAAS,CAAC,CAAC;MACjB,IAAI,CAAAG,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEK,MAAM,MAAK,GAAG,EAAE;QACvBpC,QAAQ,CAAC;UAAEyB,IAAI,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAmD,CAAC,CAAC;MACzF,CAAC,MAAM,IAAI,CAAAK,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEK,MAAM,MAAK,GAAG,EAAE;QAC9BpC,QAAQ,CAAC;UAAEyB,IAAI,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAsD,CAAC,CAAC;MAC5F,CAAC,MAAM;QACL1B,QAAQ,CAAC;UAAEyB,IAAI,EAAE,OAAO;UAAEC,OAAO,EAAE;QAAqD,CAAC,CAAC;MAC5F;IACF;EACF,CAAC;EAED,MAAM0B,cAAc,GAAG,MAAOvC,SAAS,IAAK;IAC1C,IAAI,CAAC3B,eAAe,EAAE,OAAOsC,WAAW,CAAC,CAAC;IAC1C,IAAI;MACF,MAAMlD,WAAW,CAAC8E,cAAc,CAACvC,SAAS,CAAC,CAAC,CAAC;MAC7C,MAAMe,SAAS,CAAC,CAAC;MACjB5B,QAAQ,CAAC,IAAI,CAAC;IAChB,CAAC,CAAC,OAAO+B,GAAG,EAAE;MACZG,OAAO,CAACnC,KAAK,CAAC,uBAAuB,EAAEgC,GAAG,CAAC;MAC3C,IAAI,CAAAA,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEK,MAAM,MAAK,GAAG,EAAEpC,QAAQ,CAAC;QAAEyB,IAAI,EAAE,MAAM;QAAEC,OAAO,EAAE;MAAmD,CAAC,CAAC,CAAC,KAC5G,IAAI,CAAAK,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEK,MAAM,MAAK,GAAG,EAAEpC,QAAQ,CAAC;QAAEyB,IAAI,EAAE,MAAM;QAAEC,OAAO,EAAE;MAAsD,CAAC,CAAC,CAAC,KACpH1B,QAAQ,CAAC;QAAEyB,IAAI,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAgD,CAAC,CAAC;IAC5F;EACF,CAAC;EAED,MAAM2B,SAAS,GAAG,MAAAA,CAAA,KAAY;IAC5B,IAAI,CAACnE,eAAe,EAAE,OAAOsC,WAAW,CAAC,CAAC;IAC1C,IAAI;MACF,MAAMlD,WAAW,CAAC+E,SAAS,CAAC,CAAC,CAAC,CAAC;MAC/B,MAAMzB,SAAS,CAAC,CAAC;MACjB5B,QAAQ,CAAC,IAAI,CAAC;IAChB,CAAC,CAAC,OAAO+B,GAAG,EAAE;MACZG,OAAO,CAACnC,KAAK,CAAC,kBAAkB,EAAEgC,GAAG,CAAC;MACtC,IAAI,CAAAA,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEK,MAAM,MAAK,GAAG,EAAEpC,QAAQ,CAAC;QAAEyB,IAAI,EAAE,MAAM;QAAEC,OAAO,EAAE;MAAmD,CAAC,CAAC,CAAC,KAC5G,IAAI,CAAAK,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEK,MAAM,MAAK,GAAG,EAAEpC,QAAQ,CAAC;QAAEyB,IAAI,EAAE,MAAM;QAAEC,OAAO,EAAE;MAAsD,CAAC,CAAC,CAAC,KACpH1B,QAAQ,CAAC;QAAEyB,IAAI,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAgD,CAAC,CAAC;IAC5F;EACF,CAAC;;EAED;EACAxD,SAAS,CAAC,MAAM;IACd,IAAIgB,eAAe,EAAE;MACnB0C,SAAS,CAAC,CAAC;IACb,CAAC,MAAM;MACLrC,YAAY,CAAC,EAAE,CAAC;MAChBE,SAAS,CAAC;QAAEC,UAAU,EAAE,CAAC;QAAEC,QAAQ,EAAE,CAAC;QAAEC,QAAQ,EAAE;MAAG,CAAC,CAAC;MACvDE,eAAe,CAAC,KAAK,CAAC;MACtBE,QAAQ,CAAC,IAAI,CAAC;IAChB;IACA;EACF,CAAC,EAAE,CAACd,eAAe,CAAC,CAAC;;EAErB;EACA,MAAMoE,aAAa,GAAGA,CAAA,KAAM9D,MAAM,CAACE,UAAU;EAC7C,MAAM6D,aAAa,GAAGA,CAAA,KAAM/D,MAAM,CAACG,QAAQ;EAC3C,MAAM6D,uBAAuB,GAAGA,CAAA,KAAM;IACpC,OAAOlE,SAAS,CAACmE,MAAM,CAAC,CAAC;EAC3B,CAAC;EAED,MAAMC,KAAK,GAAG;IACZpE,SAAS;IACTE,MAAM;IACNK,YAAY;IACZwC,SAAS;IACTK,cAAc;IACdU,cAAc;IACdC,SAAS;IACTzB,SAAS;IACT0B,aAAa;IACbC,aAAa;IACbC,uBAAuB;IAAE;IACzBzD;EACF,CAAC;EAED,oBACEtB,OAAA,CAACC,WAAW,CAACiF,QAAQ;IAACD,KAAK,EAAEA,KAAM;IAAA1E,QAAA,GAChCe,KAAK,iBACJtB,OAAA;MACEmF,SAAS,EAAE,sCACT,CAAA7D,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAE0B,IAAI,MAAK,MAAM,GAAG,wBAAwB,GAAG,uBAAuB,iBAC3D;MAAAzC,QAAA,EAEjBe,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAE2B;IAAO;MAAAmC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACZ,CACN,EACAhF,QAAQ;EAAA;IAAA6E,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACW,CAAC;AAE3B,CAAC;AAAC/E,GAAA,CAvOWF,YAAY;EAAA,QACYV,OAAO,EACzBD,WAAW,EACJG,QAAQ;AAAA;AAAA0F,EAAA,GAHrBlF,YAAY;AAAA,IAAAkF,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}